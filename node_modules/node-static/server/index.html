<html>
  <head>
    <meta charset='utf-8'>
    <title>Test</title>
    <link href='Content/css/font-awesome.min.css' rel='stylesheet'>
    <link href='Content/css/style.min.css' rel='stylesheet'>
    <script src='Scripts/jquery-1.12.3.min.js'></script>
    <script src='Scripts/handlebars-v4.0.5.js'></script>
    <script defer='' src='Scripts/script.js'></script>
  </head>
  <body>
    <div class='bg-login'></div>
    <div class='main-wrap clearfix'>
      <div class='login-wrap'>
        <div class='author'>
          <img class='avatar' src='images/users/anonymous.png'>
          <div class='content'>
            <span>Вы вошли как:</span>
            <br>
            <a class='person-name link' href='/'>Гость</a>
          </div>
        </div>
        <div class='login'>
          <input class='field-text' placeholder='user-id' type='text'>
          <div class='button'>Ok</div>
        </div>
      </div>
      <div class='offer-plates'>
        <div class='column'></div>
        <div class='column'></div>
        <div class='column'></div>
        <div class='column'></div>
      </div>
    </div>
  </body>
  <div class='lightbox-wrap hidden'></div>
  <script id='offer-templ' type='text/x-handlebars-template'>
    <div class='lightbox offer' data-id='{{id}}'>
      <div class='lightbox-header'>
        <div class='author'>
          <img class='avatar' src='{{author.0.avatar}}'>
          <div class='content'>
            <a class='person-name link' href='/'>{{author.0.fullname}}</a>
            <br>
            <span class='status'>Нуждается в этом</span>
          </div>
          <div class="button {{#ifCond author.0.userId '!=' user.id}}hidden{{/ifCond}}" data-button='removeOffer'>Удалить предложение</div>
        </div>
        <div class='close-item' data-button='closeOfferLightbox'>
          <span class='icon fa fa-times'></span>
          <span class='content'>Закрыть</span>
        </div>
      </div>
      <div class='lightbox-body'>
        <div class='main-content clearfix'>
          <div class='offer-content'>
            <div class='title-wrap'>
              <div class='offer-title'>{{title}}</div>
              <div class='offer-category'>{{category}}</div>
            </div>
            <div class='offer-img-wrap'>
              <img class='offer-img' src='{{img}}'>
            </div>
            <div class='offer-description'>{{description}}</div>
          </div>
          <div class='social-actions'>
            <div class="button {{#each saved.0.fromUsers}}{{#ifCond userId '==' user.id}}active{{/ifCond}}{{/each}}" data-button='save'>Добавить к себе</div>
            <div class="button {{#each likes.0.fromUsers}}{{#ifCond userId '==' user.id}}active{{/ifCond}}{{/each}}" data-button='like'>Мне нравится</div>
            <div class='button {{#if states.hiddenAnswers}}{{else}}active{{/if}}' data-button='viewAnswer'>Комменировать</div>
          </div>
        </div>
        <div class='comments {{#if states.hiddenAnswers}}hidden{{/if}}'>
          <div class='latest-comments'>
            {{#renderLatestMessages answers.0.fromUsers 3 0}}
            <div class='author' data-id='{{id}}'>
              <img class='avatar' src='{{avatar}}'>
              <div class='content'>
                <span class='comment'>{{comment}}</span>
              </div>
              {{#ifCond userId '==' ../user.id}}
              <div class='close-item'>
                <span class='icon fa fa-times' data-button='removeAnswer'></span>
              </div>
              {{/ifCond}}
            </div>
            {{/renderLatestMessages}}
          </div>
          <div class='add-answer'>
            <div class='author'>
              <img class='avatar' src='{{user.avatar}}'>
              <div class='content'>
                <textarea class='field-textarea js-answer' maxlength='500' placeholder='Комментировать'></textarea>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class='lightbox-footer'>
        {{#if saved.0.count}}
        <div class='saved-info'>
          <span class='title'>{{saved.0.count}} добавили себе</span>
          <ul class='list'>
            {{#each saved.0.fromUsers}}
            <li class='list-item'>
              <img class='avatar' src='{{avatar}}'>
            </li>
            {{/each}}
          </ul>
        </div>
        {{/if}}
        {{#if likes.0.count}}
        <div class='liked-info'>
          <span class='title'>{{likes.0.count}} нравится</span>
          <ul class='list'>
            {{#each likes.0.fromUsers}}
            <li class='list-item'>
              <img class='avatar' src='{{avatar}}'>
            </li>
            {{/each}}
          </ul>
        </div>
        {{/if}}
      </div>
    </div>
  </script>
</html>
<script id='offer-card-templ' type='text/x-handlebars-template'>
  <div class='js-offer-card-wrap' data-id='{{id}}'>
    <div class='offer-plate'>
      <div class='offer-img-wrap'>
        <img class='offer-img' src='{{img}}'>
      </div>
      <div class='view-offer' data-button='openOfferLightbox'>Ознакомиться с предложением</div>
      <div class='social-actions'>
        <div class="item fa fa-lightbulb-o {{#each saved.0.fromUsers}}{{#ifCond userId '==' ../user.id}}active{{/ifCond}}{{/each}}" data-button='save'></div>
        <div class="item fa fa-heart {{#each likes.0.fromUsers}}{{#ifCond userId '==' ../user.id}}active{{/ifCond}}{{/each}}" data-button='like'></div>
        <div class='item fa fa-plus {{#if states.hiddenComments}}{{else}}active{{/if}}' data-button='viewComment'></div>
        <div class='item fa fa-comment' data-button='openOfferLightbox'></div>
      </div>
      <div class='offer-content'>
        <div class='description'>
          <div class='offer-title'>{{title}}</div>
          <div class='offer-category'>{{category}}</div>
          <div class='offer-date'>{{dateFrom}}-{{dateTo}}</div>
          <div class='offer-location'>{{location}}</div>
        </div>
        <div class='social-info'>
          {{#if likes.0.count}}
          <span class='item count-likes'>{{likes.0.count}} нравится</span>
          {{/if}}
          {{#if comments.0.count}}
          <span class='item count-comments'>{{comments.0.count}} комментария</span>
          {{/if}}
          {{#if answers.0.count}}
          <span class='item count-answers'>{{answers.0.count}} отзыва</span>
          {{/if}}
          {{#if saved.0.count}}
          <span class='item saved-info'>{{saved.0.count}} добавили себе</span>
          {{/if}}
        </div>
        <div class='offer-author'>
          <div class='author'>
            <img class='avatar' src='{{author.0.avatar}}'>
            <div class='content'>
              <a class='person-name link' href='/'>{{author.0.fullname}}</a>
              <br>
              <span class='status'>предлагает</span>
            </div>
          </div>
        </div>
        <div class='comments {{#if states.hiddenComments}}hidden{{/if}}'>
          <div class='latest-comments'>
            {{#renderLatestMessages comments.0.fromUsers 5 40}}
            <div class='author' data-id='{{id}}'>
              <img class='avatar' src='{{avatar}}'>
              <div class='content'>
                <span class='comment'>{{comment}}</span>
              </div>
              {{#ifCond userId '==' ../user.id}}
              <div class='close-item'>
                <span class='icon fa fa-times' data-button='removeComment'></span>
              </div>
              {{/ifCond}}
            </div>
            {{/renderLatestMessages}}
          </div>
          <div class='add-comment'>
            <div class='author'>
              <img class='avatar' src='{{user.avatar}}'>
              <div class='content'>
                <input class='field-text js-comment' placeholder='Комментировать' type='text'>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</script>
<script id='user-plate-templ' type='text/x-handlebars-template'>
  <img class='avatar' src='{{avatar}}'>
  <div class='content'>
    <span>Вы вошли как:</span>
    <br>
    <a class='person-name link' href='/'>{{fullname}}</a>
  </div>
</script>
