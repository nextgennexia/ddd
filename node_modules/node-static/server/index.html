<html>
  <head>
    <meta charset='utf-8'>
    <title>Test</title>
    <link href='Content/css/font-awesome.min.css' rel='stylesheet'>
    <link href='Content/css/style.min.css' rel='stylesheet'>
    <script src='Scripts/jquery-1.12.3.min.js'></script>
    <script src='Scripts/handlebars-v4.0.5.js'></script>
    <script defer='' src='Scripts/script.js'></script>
  </head>
  <body>
    <div class='bg-login'></div>
    <div class='main-wrap clearfix'>
      <div class='login-wrap'>
        <div class='author'></div>
        <div class='login'>
          <input class='field-text js-login' placeholder='user-id' type='text'>
          <div class='button js-auth'>Ok</div>
        </div>
      </div>
      <div class='offer-plates'>
        <div class='column'></div>
        <div class='column'></div>
        <div class='column'></div>
        <div class='column'></div>
      </div>
    </div>
  </body>
  <div class='lightboxes'></div>
  <script id='offer-templ' type='text/x-handlebars-template'>
    <div class='lightbox-wrap {{#if states.hiddenOfferLightbox}}hidden{{/if}}' data-offer-id='{{id}}'>
      <div class='lightbox offer'>
        <div class='lightbox-header'>
          <div class='author'>
            <img class='avatar' src='{{author.0.avatar}}'>
            <div class='content'>
              <a class='person-name link' href='/'>{{author.0.fullname}}</a>
              <br>
              <span class='status'>Нуждается в этом</span>
            </div>
            <div class="button js-remove-offer {{#ifCond author.0.userId '!=' user.id}}hidden{{/ifCond}}" data-button='removeOffer'>Удалить предложение</div>
          </div>
          <div class='close-item js-close' data-button='closeOfferLightbox'>
            <span class='icon fa fa-times'></span>
            <span class='content'>Закрыть</span>
          </div>
        </div>
        <div class='lightbox-body'>
          <div class='main-content clearfix'>
            <div class='offer-content'>
              <div class='title-wrap'>
                <div class='offer-title'>{{title}}</div>
                <div class='offer-category'>{{category}}</div>
              </div>
              <div class='offer-img-wrap'>
                <img class='offer-img' src='{{img}}'>
              </div>
              <div class='offer-description'>{{description}}</div>
            </div>
            <div class='social-actions'>
              <div class="button js-save-lbx {{#each saved}}{{#ifCond userId '==' ../user.id}}active{{/ifCond}}{{/each}}" data-button='save-lbx'>Добавить к себе</div>
              <div class="button js-like-lbx {{#each likes}}{{#ifCond userId '==' ../user.id}}active{{/ifCond}}{{/each}}" data-button='like-lbx'>Мне нравится</div>
              <div class='button js-view-answer {{#if states.hiddenAnswers}}{{else}}active{{/if}}' data-button='viewAnswer'>Комменировать</div>
            </div>
          </div>
          <div class='comments {{#if states.hiddenAnswers}}hidden{{/if}}'>
            <div class='latest-comments'>
              {{#renderLatestMessages answers 3}}
              {{#each this}}
              <div class='author' data-message-id='{{id}}'>
                <img class='avatar' src='{{avatar}}'>
                <div class='content'>
                  <span class='comment'>{{comment}}</span>
                </div>
                {{#ifCond userId '==' ../../user.id}}
                <div class='close-item js-remove-answer'>
                  <span class='icon fa fa-times' data-button='removeAnswer'></span>
                </div>
                {{/ifCond}}
              </div>
              {{/each}}
              {{/renderLatestMessages}}
            </div>
            <div class='add-answer'>
              <div class='author'>
                <img class='avatar' src='{{user.avatar}}'>
                <div class='content'>
                  <textarea class='field-textarea js-answer' maxlength='500' placeholder='Комментировать'></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class='lightbox-footer'>
          {{#if saved.length}}
          <div class='saved-info'>
            <span class='title'>{{saved.length}} добавили себе</span>
            <ul class='list'>
              {{#each saved}}
              <li class='list-item'>
                <img class='avatar' src='{{avatar}}'>
              </li>
              {{/each}}
            </ul>
          </div>
          {{/if}}
          {{#if likes.length}}
          <div class='liked-info'>
            <span class='title'>{{likes.length}} нравится</span>
            <ul class='list'>
              {{#each likes}}
              <li class='list-item'>
                <img class='avatar' src='{{avatar}}'>
              </li>
              {{/each}}
            </ul>
          </div>
          {{/if}}
        </div>
      </div>
    </div>
  </script>
</html>
<script id='offer-card-templ' type='text/x-handlebars-template'>
  <div class='js-offer-wrap' data-offer-id='{{id}}'>
    <div class='offer-plate'>
      <div class='offer-img-wrap'>
        <img class='offer-img' src='{{img}}'>
      </div>
      <div class='view-offer js-open-offer' data-button='openOfferLightbox'>Ознакомиться с предложением</div>
      <div class='social-actions'>
        <div class="item fa fa-lightbulb-o js-save {{#each saved}}{{#ifCond userId '==' ../user.id}}active{{/ifCond}}{{/each}}" data-button='save'></div>
        <div class="item fa fa-heart js-like {{#each likes}}{{#ifCond userId '==' ../user.id}}active{{/ifCond}}{{/each}}" data-button='like'></div>
        <div class='item fa fa-plus js-view-comment {{#if states.hiddenComments}}{{else}}active{{/if}}' data-button='viewComment'></div>
        <div class='item fa fa-comment js-open-offer' data-button='openOfferLightbox'></div>
      </div>
      <div class='offer-content'>
        <div class='description'>
          <div class='offer-title'>{{title}}</div>
          <div class='offer-category'>{{category}}</div>
          <div class='offer-date'>{{dateFrom}}-{{dateTo}}</div>
          <div class='offer-location'>{{location}}</div>
        </div>
        <div class='social-info'>
          {{#if likes.length}}
          <span class='item count-likes'>{{likes.length}} нравится</span>
          {{/if}}
          {{#if comments.length}}
          <span class='item count-comments'>{{comments.length}} комментария</span>
          {{/if}}
          {{#if answers.length}}
          <span class='item count-answers'>{{answers.length}} отзыва</span>
          {{/if}}
          {{#if saved.length}}
          <span class='item saved-info'>{{saved.length}} добавили себе</span>
          {{/if}}
        </div>
        <div class='offer-author'>
          <div class='author'>
            <img class='avatar' src='{{author.0.avatar}}'>
            <div class='content'>
              <a class='person-name link' href='/'>{{author.0.fullname}}</a>
              <br>
              <span class='status'>предлагает</span>
            </div>
          </div>
        </div>
        <div class='comments {{#if states.hiddenComments}}hidden{{/if}}'>
          <div class='latest-comments'>
            {{#renderLatestMessages comments 5}}
            {{#each this}}
            <div class='author' data-message-id='{{id}}'>
              <img class='avatar' src='{{avatar}}'>
              <div class='content'>
                {{#trancate comment 40}}
                <span class='comment'>{{this}}</span>
                {{/trancate}}
              </div>
              {{#ifCond userId '==' ../../user.id}}
              <div class='close-item js-remove-comment'>
                <span class='icon fa fa-times' data-button='removeComment'></span>
              </div>
              {{/ifCond}}
            </div>
            {{/each}}
            {{/renderLatestMessages}}
          </div>
          <div class='add-comment'>
            <div class='author'>
              <img class='avatar' src='{{user.avatar}}'>
              <div class='content'>
                <input class='field-text js-comment' placeholder='Комментировать' type='text'>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</script>
<script id='user-plate-templ' type='text/x-handlebars-template'>
  <img class='avatar' src='{{avatar}}'>
  <div class='content'>
    <span>Вы вошли как:</span>
    <br>
    <a class='person-name link' href='/'>{{fullname}}</a>
  </div>
</script>
