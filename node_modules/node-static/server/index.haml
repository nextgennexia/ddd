%html
	%head
		%meta{:charset => "utf-8"}
		%title Test
		%link{:rel => "stylesheet", :href => "Content/css/font-awesome.min.css"}
		%link{:rel => "stylesheet", :href => "Content/css/style.min.css"}
		%script{:src => "Scripts/jquery-1.12.3.min.js"}
		%script{:src => "Scripts/handlebars-v4.0.5.js"}
		%script{:src => "Scripts/script.js", :defer => ""}
	%body
		.login-wrap
			.author
				%img.person-avatar{:src => "images/users/anonim.png"}
				.personal-content
					%span Вы вошли как:
					%br
					%a.person-name.link{:href => "/"} Гость
			.login
				%input.field-text{:type => "text", :placeholder => "user-id"}
				.button Ok
		.main-wrap.clearfix
			.column
			.column
			.column
			.column

	.lightbox-wrap.hidden
	%script#offer-templ{:type => "text/x-handlebars-template"}
		.lightbox.offer{:"data-id" => "{{id}}"}
			.lightbox-header
				.author
					%img.person-avatar{:src => "{{author.0.avatar}}"}
					.personal-content
						%a.person-name.link{:href => "/"} {{author.0.fullname}}
						%br
						%span.status Нуждается в этом
					{{#renderButtonRemoveOffer author}}
					%div{:class => "button {{hidden}}", :"data-button" => "removeOffer"} Удалить предложение
					{{/renderButtonRemoveOffer}}
				.close-item
					%span.icon.fa.fa-times{:"data-button" => "closeOfferLightbox"}
					%span.content{:"data-button" => "closeOfferLightbox"} Закрыть
			.lightbox-body
				.main-content.clearfix
					.offer-content
						.title-wrap
							.offer-title {{title}}
							.offer-category {{category}}
						.offer-img-wrap
							%img.offer-img{:src => "{{img}}"}
						.offer-description {{description}}
					.social-actions
						{{#save saved.0.fromUsers}}
						%div{:class => "button {{saved}}", :"data-button" => "save"} Добавить к себе
						{{/save}}
						{{#like likes.0.fromUsers}}
						%div{:class => "button {{liked}}", :"data-button" => "like"} Мне нравится
						{{/like}}
						.button{:"data-button" => "viewComment"} Комменировать
				.comments.hidden
					.latest-comments
						{{#renderLatestAnswers answers.0.fromUsers}}
						.author{:"data-id" => "{{id}}"}
							%img.person-avatar{:src => "{{avatar}}"}
							.personal-content
								%span.comment {{comment}}
							{{#renderCloseElement userId}}
							.close-item
								%span.icon.fa.fa-times{:"data-button" => "removeAnswer"}
							{{/renderCloseElement}}
						{{/renderLatestAnswers}}
					.add-answer
			.lightbox-footer
				{{#if saved.0.count}}
				.saved-info
					{{#renderCountActions saved.0.count}}
					%span.title {{this}} добавили себе
					{{/renderCountActions}}
					%ul.list
						{{#each saved.0.fromUsers}}
						%li.list-item
							%img.person-avatar{:src => "{{avatar}}"}
						{{/each}}
				{{/if}}
				{{#if likes.0.count}}
				.liked-info
					{{#renderCountActions likes.0.count}}
					%span.title {{this}} нравится
					{{/renderCountActions}}
					%ul.list
						{{#each likes.0.fromUsers}}
						%li.list-item
							%img.person-avatar{:src => "{{avatar}}"}
						{{/each}}
				{{/if}}


%script#offer-plate-templ{:type => "text/x-handlebars-template"}
	.offer-plate{:"data-id" => "{{id}}"}
		.offer-img-wrap
			%img.offer-img{:src => "{{img}}"}
		.view-offer{:"data-button" => "openOfferLightbox"} Ознакомиться с предложением
		.social-actions
			{{#save saved.0.fromUsers}}
			%div{:class => "item fa fa-lightbulb-o {{saved}}", :"data-button" => "save"}
			{{/save}}
			{{#like likes.0.fromUsers}}
			%div{:class => "item fa fa-heart {{liked}}", :"data-button" => "like"}
			{{/like}}
			.item.fa.fa-plus{:"data-button" => "viewComment"}
			.item.fa.fa-comment{:"data-button" => "openOfferLightbox"}
		.offer-content
			.description
				.offer-title {{title}}
				.offer-category {{category}}
				.offer-date {{dateFrom}}-{{dateTo}}
				.offer-location {{location}}
			.social-info
				{{#renderCountActions likes.0.count}}
				%span.item.count-likes {{this}} нравится
				{{/renderCountActions}}
				{{#renderCountActions comments.0.count}}
				%span.item.count-comments {{this}} комментария
				{{/renderCountActions}}
				{{#renderCountActions answers.0.count}}
				%span.item.count-answers {{this}} отзыва
				{{/renderCountActions}}
				{{#renderCountActions saved.0.count}}
				%span.item.saved-info {{this}} добавили себе
				{{/renderCountActions}}
			.offer-author
				.author
					%img.person-avatar{:src => "{{author.0.avatar}}"}
					.personal-content
						%a.person-name.link{:href => "/"} {{author.0.fullname}}
						%br
						%span.status предлагает
			.comments.hidden
				.latest-comments
					{{#renderLatestComments comments.0.fromUsers}}
					.author{:"data-id" => "{{id}}"}
						%img.person-avatar{:src => "{{avatar}}"}
						.personal-content
							%span.comment {{comment}}
						{{#renderCloseElement userId}}
						.close-item
							%span.icon.fa.fa-times{:"data-button" => "removeComment"}
						{{/renderCloseElement}}
					{{/renderLatestComments}}
				.add-comment

%script#add-comment-templ{:type => "text/x-handlebars-template"}
	.author
		%img.person-avatar{:src => "{{avatar}}"}
		.personal-content
			%input.field-text.js-comment{:type => "text", :placeholder => "Комментировать"}

%script#add-answer-templ{:type => "text/x-handlebars-template"}
	.author
		%img.person-avatar{:src => "{{avatar}}"}
		.personal-content
			%textarea.field-textarea.js-answer{:placeholder => "Комментировать", :maxlength => "500"}

%script#user-plate-templ{:type => "text/x-handlebars-template"}
	%img.person-avatar{:src => "{{avatar}}"}
	.personal-content
		%span Вы вошли как:
		%br
		%a.person-name.link{:href => "/"} {{fullname}}